<!DOCTYPE html>
<html>
<p> </p>
<div>
zNear .01<input id="zNearSlider" type="range"
 min=".01" max="3" step="0.1" value="1" />
 3
</div>
<div>
zFar 3<input id="zFarSlider" type="range"
 min="3" max="9" step="3.0" value="9" />
 10
</div>
<div>
radius 0.05<input id="radiusSlider" type="range"
 min="0.05" max="10" step="0.1" value="3.4" />
 10
</div>
<div>
theta -90<input id="thetaSlider" type="range"
 min="-90" max="90" step="5" value="0.52" />
 90
</div>
<div>
phi -90<input id="phiSlider" type="range"
 min="-90" max="90" step="5" value="-0.785" />
 90
</div>
<div>
fov 10<input id="fovSlider" type="range"
 min="10" max="120" step="5" value="70" />
 120
</div>
<div>
aspect 0.5<input id="aspectSlider" type="range"
 min="0.5" max="2" step="0.1" value="1" />
 2
</div>


<script id="vertex-shader" type="x-shader/x-vertex">
#version 300 es

in  vec4 aPosition;
in vec4 aNormal;
out vec3 N, L, E;

uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;
uniform vec4 uLightPosition;
uniform mat3 uNormalMatrix;



void main()
{
  /*vec3 pos = (uModelViewMatrix * aPosition).xyz;

  //fixed light postion

  vec3 light = uLightPosition.xyz;
  vec3 L = normalize(light - pos);


  vec3 E = normalize(-pos);
  //vec3 H = normalize(L + E);

  vec4 NN = vec4(aNormal,0);

  // Transform vertex normal into eye coordinates

  vec3 N = normalize((uModelViewMatrix*NN).xyz);*/

  vec3 light;
  vec3 pos = (uModelViewMatrix * aPosition).xyz;
  if(uLightPosition.z == 0.0)  L = normalize(uLightPosition.xyz);
  else  L = normalize(uLightPosition).xyz - pos;

  E =  -normalize(pos);
  N = normalize(uNormalMatrix*aNormal.xyz);
  gl_Position = uProjectionMatrix * uModelViewMatrix *aPosition;
}
</script>

<script id="fragment-shader" type="x-shader/x-fragment">
#version 300 es

precision mediump float;

uniform vec4 uAmbientProduct, uDiffuseProduct, uSpecularProduct;
uniform float uShininess;

/*uniform vec4 spotLightPosition;
uniform vec4 spotAmbientProduct, spotDiffuseProduct,spotSpecularProduct;
uniform vec4 spotLightDirection;
uniform float lCutOff;
uniform float spotAlhpa;*/

in vec3 N, L, E;
out vec4 fColor;


void
main()
{
  vec3 H = normalize( L + E );
  vec4 ambient = uAmbientProduct;

  float Kd = max( dot(L, N), 0.0 );
  vec4  diffuse = Kd*uDiffuseProduct;

  float Ks = pow( max(dot(N, H), 0.0), uShininess );
  vec4  specular = Ks * uSpecularProduct;

  if( dot(L, N) < 0.0 ) specular = vec4(0.0, 0.0, 0.0, 1.0);

  fColor = ambient + diffuse +specular;
  fColor.a = 1.0;



  //spotlight
    /*vec3 spotLight=spotLightPosition.xyz;
    vec3 spotL=normalize(spotLight);
    vec3 spotE=normalize(-pos);
    vec3 spotH=normalize(spotL+spotE);
    vec3 spotD=spotLightDirection.xyz;
    vec4 spotAmbient=spotAmbientProduct;
    float spotKd=max(dot(spotL,N),0.0);
    vec4 spotDiffuse=spotKd*spotDiffuseProduct;
    float spotKs=pow(max(dot(N,spotH),0.0), uShininess);
    vec4 spotSpecular=spotKs*spotSpecularProduct;
    if(dot(spotL,N)<0.0){
    spotSpecular=vec4(0.0,0.0,0.0,1.0);
    }
    float lEffect= dot(normalize(spotD), normalize((spotL+spotE)));
    if(lEffect>lCutOff)
    {
      fColor = spotAmbient + spotDiffuse + spotDiffuse;
    } else {
      fColor = ambient + diffuse + specular;
    }*/


}
</script>

<script type="text/javascript" src="../Common/InitShaders.js"></script>
<script type="text/javascript" src="../Common/MVnew.js"></script>
<script type="text/javascript" src="homework1.js"></script>

<body>

<canvas id="gl-canvas" width="1024" height="1024">
Oops ... your browser doesn't support the HTML5 canvas element
</canvas>
</body>
</html>
